---
title: PR通知到企业微信群
permalink: https://docs.cnb.cool/zh/build/showcase/pr-notice-group.html
summary: 该文档介绍了如何将PR（拉取请求）相关通知发送到企业微信群。首先要在企业微信群添加机器人并复制 `Webhook` 地址，然后在流水线配置中针对PR的不同状态（如需评审、需要改进、已合并、可自动合并等），设定对应的阶段和发送包含相关信息（如标题、发起人、评审人等，部分信息使用变量表示）的通知内容 。
---
## 添加群机器人

于企业微信群中添加机器人，复制得到的 `Webhook` 地址。

## 配置流水线

示例：

```yaml
main:
  pull_request:
    - stages:
        - name: notice
          image: tencentcom/wecom-message
          settings:
            robot: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=xxx
            content: |
              > **PR 需要评审：**
              > **标  题:** ${CNB_PULL_REQUEST_TITLE}
              > **发起人:** ${CNB_PULL_REQUEST_PROPOSER}
              > [查看详情]($CNB_EVENT_URL)
  pull_request.changes_requested:
    - stages:
        - name: notice
          image: tencentcom/wecom-message
          settings:
            robot: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=xxx
            content: |
              > **PR 需要改进：**
              > **标  题:** ${CNB_PULL_REQUEST_TITLE}
              > **发起人:** ${CNB_PULL_REQUEST_PROPOSER}
              > **评审人:** ${CNB_BUILD_USER}
              > [查看详情]($CNB_EVENT_URL)
  pull_request.merged:
    - stages:
        - name: notice
          image: tencentcom/wecom-message
          settings:
            robot: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=xxx
            content: |
              > **PR 已合并：**
              > **标  题:** ${CNB_PULL_REQUEST_TITLE}
              > **发起人:** ${CNB_PULL_REQUEST_PROPOSER}
              > [查看详情]($CNB_EVENT_URL)
  pull_request.mergeable:
    - stages:
        - name: auto merge
          type: git:auto-merge
          options:
            mergeType: squash
            removeSourceBranch: true
        - name: notice
          image: tencentcom/wecom-message
          settings:
            robot: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=xxx
            content: |
              > **PR 自动合并：**
              > **标  题:** ${CNB_PULL_REQUEST_TITLE}
              > **发起人:** ${CNB_PULL_REQUEST_PROPOSER}
              > [查看详情]($CNB_EVENT_URL)
```

`robot` 填之前复制的 `Webhook` 地址。

具体信息格式可自定义，可用变量参考[环境变量](../env.md)。
