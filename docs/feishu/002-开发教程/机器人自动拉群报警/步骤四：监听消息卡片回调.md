---
title: "步骤四：监听消息卡片回调"
source_url: https://open.feishu.cn/document/home/message-development-tutorial/monitor-and-interact-with-messages-in-the-group
last_remote_update: 2025-04-07
last_remote_update_timestamp: 1744024000000
---
最后更新于 2025-04-07

# 步骤四：监听消息卡片回调

在上一步骤中，已启动了本地服务并监听 **7777** 端口，本步骤中需要将本机地址配置到消息卡片回调地址，然后进行卡片交互。warning
若本机无公网地址，需使用反向代理工具（[ngrok](https://ngrok.com/download)）完成内网穿透，暴露本地服务的公网访问入口。使用方式可参考[配置事件订阅](https://open.feishu.cn/document/home/develop-a-bot-in-5-minutes/step-5-configure-event-subscription)。**该工具仅适用于开发测试阶段，不可用于生产环境，使用前请确认是否符合所在公司网络安全政策。**

代码实现所使用的能力如下：

- [卡片回调地址](https://open.feishu.cn/document/ukTMukTMukTM/uYzMxEjL2MTMx4iNzETM)

- [消息卡片回传交互（旧）](https://open.feishu.cn/document/ukTMukTMukTM/uYzM3QjL2MzN04iNzcDN/configuring-card-callbacks/card-callback-structure)

- [获取 tenant_access_token](https://open.feishu.cn/document/ukTMukTMukTM/ukDNz4SO0MjL5QzM/auth-v3/auth/tenant_access_token_internal)

- [获取群信息](https://open.feishu.cn/document/uAjLw4CM/ukTMukTMukTM/reference/im-v1/chat/get)

- [更新群信息](https://open.feishu.cn/document/uAjLw4CM/ukTMukTMukTM/reference/im-v1/chat/update)

## 操作步骤

1. 登录[开发者后台](https://open.feishu.cn/app)， 然后进入应用详情页。
2. 在左侧导航栏进入 **事件与回调** 页面。
3. 在 **回调配置** 页签，点击 **订阅方式** 右侧编辑图标。
4. 在 **请求地址** 输入框内，填写你的卡片回调地址，并点击 **保存**。

地址格式为 `URL/card`，示例值：`https://www.example.com/card`。

![image.png](https://sf3-cn.feishucdn.com/obj/open-platform-opendoc/7450102ebd84f3e4e6a0007ec522d32c_OT93meU1Dp.png?height=1006&lazyload=true&maxWidth=600&width=1848)

6. 在 **已订阅的回调** 区域，点击 **添加回调**，并添加 **消息卡片回传交互（旧）** 回调。

![image.png](https://sf3-cn.feishucdn.com/obj/open-platform-opendoc/4641aa9bb4f3bfe0364ddd0552863f18_oJJaiwgiKP.png?height=574&lazyload=true&maxWidth=600&width=2186)

7. 配置完成后，返回飞书客户端，在群组内的消息卡片中，点击 **跟进处理** 按钮。

![image.png](https://sf3-cn.feishucdn.com/obj/open-platform-opendoc/fba608bfe6ab034ec53d0737e2f90a3e_pRb1rxXoqt.png?height=1498&lazyload=true&maxWidth=600&width=2116)

卡片和群名称会修改为 `跟进中`。

![image.png](https://sf3-cn.feishucdn.com/obj/open-platform-opendoc/dc8d242c2b3313f022fb435e96bdbd71_UMBsFrvosl.png?height=1506&lazyload=true&maxWidth=600&width=2148)
