# ==============================================================================
# AI 汇报流水线公共环境变量
# ==============================================================================

# ------------------------------------------------------------------------------
# 基础运行环境
# ------------------------------------------------------------------------------

# 时区设置，用于确定日报/周报/月报的时间范围计算
TZ: Asia/Shanghai

# CNB 构建节点架构，指定使用 AMD64 架构的构建机
RUNNER_ARCH: cnb:arch:amd64

# ------------------------------------------------------------------------------
# OpenCode AI 配置
# ------------------------------------------------------------------------------

# OpenCode 使用的 AI 模型，用于生成结构化中文汇报
OPENCODE_MODEL: "opencode/grok-code"

# 是否启用 Zen 模式（非交互式模式），1=启用
ZEN_MODE: "1"

# 是否要求 AI 汇总必须成功，1=必须成功否则任务失败，0=失败时回退到基础统计
REQUIRE_AI_SUMMARY: "1"

# ------------------------------------------------------------------------------
# Git Diff 采样配置
# ------------------------------------------------------------------------------

# Diff 模式：stats=仅统计, sampled_patch=采样补丁, full_patch=完整补丁
REPORT_DIFF_MODE: "sampled_patch"

# Diff 内容的字符预算上限（字节），超出后截断
REPORT_DIFF_CHAR_BUDGET: "200000"

# 每个 commit 最多采样的文件数量
REPORT_DIFF_TOP_FILES: "20"

# 每个文件最多采样的 hunk（代码块）数量
REPORT_DIFF_HUNKS_PER_FILE: "3"

# 最多处理的 commit 数量
REPORT_DIFF_MAX_COMMITS: "100"

# numstat 输出的最大行数限制（AI 会自行决定读取多少，此处设置较大值）
REPORT_NUMSTAT_LINES: "100000"

# 排除的文件 glob 模式，多个模式用分号分隔（依赖、构建产物、二进制文件等）
REPORT_EXCLUDE_GLOBS: "node_modules/**;dist/**;vendor/**;*.min.*;*.png;*.jpg;*.jpeg;*.gif;*.webp;*.svg;*.mp4;*.mov;*.zip;*.tar;*.gz;*.lock"

# ------------------------------------------------------------------------------
# 汇报发布配置
# ------------------------------------------------------------------------------

# 是否启用汇报发布到目标仓库，1=启用
REPORT_PUBLISH_ENABLE: "1"

# 汇报发布的目标仓库 URL
REPORT_PUBLISH_REPO_URL: "https://cnb.cool/1024hub/plane-test"

# 汇报发布的目标分支
REPORT_PUBLISH_BRANCH: "main"

# 汇报发布的目标目录（会按 daily/weekly/monthly 子目录组织）
REPORT_PUBLISH_DIR: "ai-report"

# ------------------------------------------------------------------------------
# 后端 API 配置
# ------------------------------------------------------------------------------

# 是否从后端 API 拉取多仓库配置，1=启用
REPORT_CONFIG_FROM_API: "1"

# Cabb 后端 API 地址，用于获取汇报配置和多仓库列表
CABB_API_BASE: "https://api.cnb-plane.1024hub.org"
